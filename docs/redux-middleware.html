<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>
      reduxç³»åˆ—äºŒï¼šreduxä¸­é—´ä»¶å®ç°åŸç† | Syp's Blog
    </title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/_assets/style.25bd4e72.css">
    <link rel="modulepreload" href="/_assets/common-bec3f312.js">
    <link rel="modulepreload" href="/_assets/docs_redux-middleware.md.13ec1bf0.lean.js">
    <link rel="modulepreload" href="/_assets/app.4edbcaaa.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="Syp&#39;s Blog">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
    <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
    <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
    
  </head>
  <body>
    <div id="app"><!--[--><div id="containerColor" class="no-sidebar theme" data-v-79566ff1><header class="navbar" data-v-79566ff1><!-- <div class="body-bg" style="background: url(&quot;https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200507175828.jpeg&quot;) center center / cover no-repeat;opacity: 0.5;position: fixed;left: 0;top: 0;z-index: -999999;height: 100vh;width: 100vw;transition: background .5s;"></div> --><!--[--><a class="title" aria-label="Syp&#39;s Blog, back to home" href="/"><img class="logo" src="/favicon.ico" alt="logo"><span>Syp&#39;s Blog</span></a><div class="flex-grow"></div><nav class="nav-links hide-mobile" data-v-79566ff1><!--[--><!--[--><div class="nav-item" data-v-79566ff1><a class="nav-link" href="/" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-79566ff1><a class="nav-link" href="/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-79566ff1><a class="nav-link" href="/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--[--><!--]--><!--]--><!--]--><div class="sidebar-button" data-v-79566ff1><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div></header><aside class="" data-v-79566ff1><!--[--><nav class="nav-links show-mobile" data-v-79566ff1><!--[--><!--[--><div class="nav-item" data-v-79566ff1><a class="nav-link" href="/" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-79566ff1><a class="nav-link" href="/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-79566ff1><a class="nav-link" href="/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--[--><!--]--><!--]--><ul class="sidebar"><!--[--><!--]--></ul><!--[--><!--[--><!--]--><!--]--><!--]--></aside><!----><!-- TODO: make this button accessible --><div class="sidebar-mask" data-v-79566ff1></div><main data-v-79566ff1><!--[--><div class="content"><!--[--><!--[--><!--]--><!--]--><div class="md-header"><div class="md-title">reduxç³»åˆ—äºŒï¼šreduxä¸­é—´ä»¶å®ç°åŸç†</div><!-- <span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span> --><div class="md-date">2022-01-06</div></div><ul class="catalog"><!--[--><li class="catalog-item"><a class="level level-2" href="#reduxä¸­é—´ä»¶åŸç†">reduxä¸­é—´ä»¶åŸç†</a><!----></li><li class="catalog-item"><!----><a class="level level-3" href="#reduxä¸­é—´ä»¶ä¸­ä½¿ç”¨çš„èšåˆå‡½æ•°-compose">reduxä¸­é—´ä»¶ä¸­ä½¿ç”¨çš„èšåˆå‡½æ•°(Compose)</a></li><li class="catalog-item"><!----><a class="level level-3" href="#reduxä¸­é—´ä»¶å®ç°åŸç†">reduxä¸­é—´ä»¶å®ç°åŸç†</a></li><li class="catalog-item"><!----><a class="level level-3" href="#middleware">MiddleWare</a></li><!--]--></ul><div data-v-79566ff1><h2 id="reduxä¸­é—´ä»¶åŸç†"><a class="header-anchor" href="#reduxä¸­é—´ä»¶åŸç†" aria-hidden="true">#</a> reduxä¸­é—´ä»¶åŸç†</h2><h3 id="reduxä¸­é—´ä»¶ä¸­ä½¿ç”¨çš„èšåˆå‡½æ•°-compose"><a class="header-anchor" href="#reduxä¸­é—´ä»¶ä¸­ä½¿ç”¨çš„èšåˆå‡½æ•°-compose" aria-hidden="true">#</a> reduxä¸­é—´ä»¶ä¸­ä½¿ç”¨çš„èšåˆå‡½æ•°(Compose)</h3><p>å…ˆçœ‹å‡ ä¸ªå‡½æ•°</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fn1:&#39;</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fn2:&#39;</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fn3:&#39;</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦‚ä½•æ‰§è¡Œè¿™ä¸‰ä¸ªå‡½æ•°?</p><div class="language-js"><pre><code><span class="token function">fn1</span><span class="token punctuation">(</span><span class="token string">&#39;args&#39;</span><span class="token punctuation">)</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token string">&#39;args&#39;</span><span class="token punctuation">)</span>
<span class="token function">fn3</span><span class="token punctuation">(</span><span class="token string">&#39;args&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™æ ·å¾ˆå•°å—¦,ä¼˜åŒ–ä¸€ä¸‹</p><div class="language-js"><pre><code><span class="token comment">// å…ˆå°†å‡½æ•°æ”¹å†™ä¸€ä¸‹,ä½¿å…¶è¿”å›æ”¹å†™åçš„å‚æ•°</span>
<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    args <span class="token operator">=</span> args <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fn1:&#39;</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> args<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    args <span class="token operator">=</span> args <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fn2:&#39;</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> args<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    args <span class="token operator">=</span> args <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fn3:&#39;</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> args<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨å¯ä»¥è¿™æ ·è°ƒç”¨:</p><div class="language-js"><pre><code><span class="token function">f1</span><span class="token punctuation">(</span><span class="token function">f2</span><span class="token punctuation">(</span><span class="token function">f3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿˜æ˜¯ä¸å¤Ÿå‹å¥½,èƒ½å¦å°†ä¸‰ä¸ªå‡½æ•°èšåˆæˆä¸€ä¸ªå‡½æ•°,ç„¶åç›´æ¥è°ƒç”¨èšåˆåçš„å‡½æ•°å³å¯?</p><p>å¯ä»¥!ä¸‹é¢å°±æ˜¯èšåˆå‡½æ•°çš„å®ç°,reduxä¸­çš„ä¸­é—´ä»¶å°±æ˜¯ç”¨composeå‡½æ•°èšåˆçš„.</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter">funcArray<span class="token operator">:</span> Function<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">:</span> Function <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>funcArray<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token parameter">args</span> <span class="token operator">=&gt;</span> args
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>funcArray<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> funcArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> funcArray<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">res</span><span class="token punctuation">(</span><span class="token function">cur</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="reduxä¸­é—´ä»¶å®ç°åŸç†"><a class="header-anchor" href="#reduxä¸­é—´ä»¶å®ç°åŸç†" aria-hidden="true">#</a> reduxä¸­é—´ä»¶å®ç°åŸç†</h3><h4 id="å…ˆçœ‹applymiddleware"><a class="header-anchor" href="#å…ˆçœ‹applymiddleware" aria-hidden="true">#</a> å…ˆçœ‹applyMiddleWare</h4><p>ä½¿ç”¨</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;redux&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&#39;redux-thunk&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> reducers <span class="token keyword">from</span> <span class="token string">&#39;./reducers&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducers<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹:applyMiddlewareåœ¨åˆ›å»ºstoreæ—¶å°±è°ƒç”¨äº†,çœ‹çœ‹æºç å®ƒåšäº†ä»€ä¹ˆ,è¿”å›äº†ä»€ä¹ˆ.</p><div class="language-js"><pre><code><span class="token comment">// æ ¸å¿ƒæºç </span>
<span class="token comment">// æ¥å—å¤šä¸ªä¸­é—´ä»¶(å‡½æ•°),è¿”å›ä¸€ä¸ªå‡½æ•°</span>
<span class="token function">applyMiddleware</span><span class="token punctuation">(</span>
  <span class="token operator">...</span>middlewares<span class="token operator">:</span> Middleware<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token operator">:</span> StoreEnhancer<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¿”å›ä¸€ä¸ªå‡½æ•°,è¯¥å‡½æ•°çš„å‚æ•°æ˜¯createStore,è¿”å›å€¼æ˜¯æ”¹å†™åŸstore</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">createStore<span class="token operator">:</span> StoreEnhancerStoreCreator</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token operator">&lt;</span><span class="token constant">S</span><span class="token punctuation">,</span> <span class="token constant">A</span> <span class="token keyword">extends</span> <span class="token class-name">AnyAction</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
      <span class="token parameter">reducer<span class="token operator">:</span> Reducer<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token punctuation">,</span> <span class="token constant">A</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
      preloadedState<span class="token operator">?</span><span class="token operator">:</span> PreloadedState<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token operator">&gt;</span></span>
    <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> preloadedState<span class="token punctuation">)</span>
      <span class="token keyword">let</span> dispatch<span class="token operator">:</span> <span class="token function-variable function">Dispatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
          <span class="token string">&#39;Dispatching while constructing your middleware is not allowed. &#39;</span> <span class="token operator">+</span>
            <span class="token string">&#39;Other middleware would not be applied to this dispatch.&#39;</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> middlewareAPI<span class="token operator">:</span> MiddlewareAPI <span class="token operator">=</span> <span class="token punctuation">{</span>
        getState<span class="token operator">:</span> store<span class="token punctuation">.</span>getState<span class="token punctuation">,</span>
        <span class="token comment">// dispatch</span>
        <span class="token function-variable function">dispatch</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// ä¸­é—´ä»¶çš„ç¬¬ä¸€å±‚å‡½æ•°æ˜¯åœ¨è¿™é‡Œè°ƒç”¨çš„</span>
      <span class="token keyword">const</span> chain <span class="token operator">=</span> middlewares<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">middleware</span> <span class="token operator">=&gt;</span> <span class="token function">middleware</span><span class="token punctuation">(</span>middlewareAPI<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token comment">// ä½¿ç”¨composeè¿›è¡Œèšåˆ</span>
      dispatch <span class="token operator">=</span> compose<span class="token operator">&lt;</span><span class="token keyword">typeof</span> dispatch<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">...</span>chain<span class="token punctuation">)</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span>
    <span class="token comment">// å¯ä»¥çœ‹åˆ°,è¿”å›å€¼ä¸åŸstoreå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ”¹å†™(å¢å¼º)äº†dispatch,è¿™ä¾¿æ˜¯applyMiddleWareçš„ä½œç”¨</span>
    <span class="token comment">// ä¹Ÿæ˜¯ä¸­é—´ä»¶æœ€ç»ˆçš„ç›®çš„</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>store<span class="token punctuation">,</span>
        dispatch
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="æ€»ç»“ä¸€ä¸‹applymiddle"><a class="header-anchor" href="#æ€»ç»“ä¸€ä¸‹applymiddle" aria-hidden="true">#</a> æ€»ç»“ä¸€ä¸‹applyMiddle</h5><ul><li>é¦–å…ˆ,å®ƒæ˜¯ä¸€ä¸ªä¸‰ç®­å¤´å‡½æ•°,æ¥å—å¤šä¸ªä¸­é—´ä»¶(å‡½æ•°),è¿”å›ä¸€ä¸ªåŒç®­å¤´å‡½æ•°</li><li>æœ€ä¸‹å±‚çš„è¿”å›å€¼å‡½æ•°,å®ƒçš„å‚æ•°æ˜¯createStore,å®ƒçš„è¿”å›å€¼æ˜¯æ”¹å†™åŸstore</li><li>æœ€ä¸‹å±‚è¿”å›å€¼å‡½æ•°çš„è¿”å›å€¼,å®é™…ä¸Šå°±æ˜¯ç”¨createStoreåˆ›å»ºåŸstore,ç„¶åé€šè¿‡ä¸­é—´ä»¶å°†dispatchå¢å¼º,ç„¶åå†å°†æ–°çš„storeä½œä¸ºè¿”å›å€¼</li><li>ä¸­é—´ä»¶çš„ç¬¬ä¸€å±‚å‡½æ•°æ˜¯åœ¨è¿™é‡Œè°ƒç”¨çš„,å¹¶å°†è°ƒç”¨è¿”å›çš„å‡½æ•°ç”¨composeå‡½æ•°èšåˆ</li></ul><h4 id="createstoreåšäº†ä»€ä¹ˆ"><a class="header-anchor" href="#createstoreåšäº†ä»€ä¹ˆ" aria-hidden="true">#</a> createStoreåšäº†ä»€ä¹ˆ</h4><p>é™¤äº†ä¸Šæ–‡è¯´çš„,æºç ä¸­çš„createStoreå®é™…ä¸Šé¦–å…ˆçœ‹å…¥å‚é‡Œæœ‰æ²¡æœ‰enhancer(applyMiddlewareçš„æ‰§è¡Œç»“æœ),å¦‚æœæœ‰åˆ™æ‰§è¡Œenhancer:</p><div class="language-js"><pre><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> enhancer <span class="token operator">!==</span> <span class="token string">&#39;undefined&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> enhancer <span class="token operator">!==</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Expected the enhancer to be a function. Instead, received: &#39;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">kindOf</span><span class="token punctuation">(</span>
          enhancer
        <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&#39;</span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">enhancer</span><span class="token punctuation">(</span>createStore<span class="token punctuation">)</span><span class="token punctuation">(</span>
      reducer<span class="token punctuation">,</span>
      preloadedState <span class="token keyword">as</span> PreloadedState<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span> <span class="token keyword">as</span> Store<span class="token operator">&lt;</span>ExtendState<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token punctuation">,</span> StateExt<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token constant">A</span><span class="token punctuation">,</span> StateExt<span class="token punctuation">,</span> Ext<span class="token operator">&gt;</span> <span class="token operator">&amp;</span> Ext
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="middleware"><a class="header-anchor" href="#middleware" aria-hidden="true">#</a> MiddleWare</h3><h4 id="middlewareé•¿ä»€ä¹ˆæ ·"><a class="header-anchor" href="#middlewareé•¿ä»€ä¹ˆæ ·" aria-hidden="true">#</a> MiddleWareé•¿ä»€ä¹ˆæ ·?</h4><div class="language-js"><pre><code><span class="token comment">// Middleware written as ES5 functions</span>
<span class="token comment">// Outer function:</span>
<span class="token keyword">function</span> <span class="token function">exampleMiddleware</span><span class="token punctuation">(</span><span class="token parameter">storeAPI</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">wrapDispatch</span><span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">handleAction</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Do anything here: pass the action onwards with next(action),</span>
      <span class="token comment">// or restart the pipeline with storeAPI.dispatch(action)</span>
      <span class="token comment">// Can also use storeAPI.getState() here</span>

      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>æœ€å¤–å±‚å°±æ˜¯middlewareæœ¬èº«,å®ƒåœ¨applyMiddlewareä¸­è¢«è°ƒç”¨<code>const chain = middlewares.map(middleware =&gt; middleware(middlewareAPI))</code>,å½“æˆ‘ä»¬åœ¨ä¸šåŠ¡ä»£ç ä¸­è°ƒç”¨dispatchæ—¶å°±ä¼šå°†actionæ´¾å‘åˆ°ç¬¬ä¸€ä¸ªmiddleware.åªæ‰§è¡Œä¸€é</li><li>wrapDispatch:(å®˜æ–¹æ–‡æ¡£ä¸­å†™This function is actually the next middleware in the pipeline.)è¯¥å‡½æ•°ä¹Ÿæ˜¯åœ¨applyMiddlewareä¸­è°ƒç”¨<code>dispatch = compose&lt;typeof dispatch&gt;(...chain)(store.dispatch)</code>,æœ€åä¸€ä¸ªmiddlewareä¸­çš„nextå°±æ˜¯strore.dispatch.åªæ‰§è¡Œä¸€é.</li><li>handleAction: æ¯æ¬¡dispatchéƒ½ä¼šè§¦å‘,æ¥å—actionå‚æ•°.</li></ul><h4 id="åŠ¨æ‰‹å†™ä¸€ä¸ªloggerä¸­é—´ä»¶"><a class="header-anchor" href="#åŠ¨æ‰‹å†™ä¸€ä¸ªloggerä¸­é—´ä»¶" aria-hidden="true">#</a> åŠ¨æ‰‹å†™ä¸€ä¸ªloggerä¸­é—´ä»¶</h4><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">loggerMiddleware</span> <span class="token operator">=</span> <span class="token parameter">storeAPI</span> <span class="token operator">=&gt;</span> <span class="token parameter">next</span> <span class="token operator">=&gt;</span> <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;dispatching&#39;</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;next state&#39;</span><span class="token punctuation">,</span> storeAPI<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
</code></pre></div></div><div class="links-wrapper" data-v-79566ff1><div class="prev-link"><!----></div><div class="next-link"><!----></div></div><div data-v-79566ff1><!-- <footer class="page-edit">
      <a v-for="(item,index) in data.platform" :key="index" :href="item.href"><img class="imgIcon" :src="item.icon" ></a>
      </footer>
     <p class="platform">ä»¥ä¸Šçš†ä¸º <a href="javascript:;">æ‚²ä¼¤æ—¥è®°</a> æ–‡ç« å‘å¸ƒå¹³å°</p> --><p class="platform"> Copyright Â© 2020-2021 <a href="https://github.com/CrazyMrYan">@Syp</a></p></div><!--[--><!--[--><!--]--><!--]--></div><!-- åªæƒ³ç‚¹å‡»èƒŒæ™¯æ‰å…³é—­ è¯·ä½¿ç”¨ .self ä¿®é¥°ç¬¦ --><div style="display:none;" class="imgBox"><img src=""></div><!--]--></main><div class="theme-select" data-v-79566ff1><ul data-v-79566ff1><li class="active" data-v-79566ff1> â˜€ï¸ </li><li class="" data-v-79566ff1> ğŸŒ‘ </li></ul></div></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"8f402100\",\"README.md\":\"fe610456\",\"docs_deep-going-react-01.md\":\"43ae0b64\",\"docs_deepCopy.md\":\"c8379117\",\"docs_how-to-write-a-patent.md\":\"d715321b\",\"docs_optimize.md\":\"2f800130\",\"docs_redux&react-redux.md\":\"e2425f3e\",\"docs_redux-middleware.md\":\"13ec1bf0\",\"docs_string-to-number.md\":\"f6280858\",\"docs_tools.md\":\"b161773b\",\"docs_website-Monitoring.md\":\"1b54fe4d\",\"docs_website-Monitoring2.md\":\"5890a03b\",\"docs_why-keep-blogging.md\":\"f3c79b0a\",\"docs_wx-miniprograme-part1.md\":\"dbad4f32\",\"more_docs.md\":\"5526df53\",\"more_Friendship.md\":\"746f349d\",\"more_index.md\":\"6f6f6489\",\"more_subscribe.md\":\"c9d6d924\",\"more_tags.md\":\"91f60878\",\"more_update-log.md\":\"3bcf9854\"}")</script>
    <script type="module" async src="/_assets/app.4edbcaaa.js"></script>
  </body>
</html>
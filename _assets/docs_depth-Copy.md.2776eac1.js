import{g as n,j as s,G as a,f as p,q as t}from"./common-bec3f312.js";const o='{"title":"浅谈深浅拷贝｜手摸手带你入坑","frontmatter":{"date":"2021-03-17","title":"浅谈深浅拷贝｜手摸手带你入坑","tags":[2021,"深浅拷贝"],"describe":"再次谈及深拷贝，已经过了两三年了！花有重开日人无再少年啊，从当初的懵懵懂懂到现在的油腻大叔，害"},"headers":[{"level":2,"title":"前言","slug":"前言"},{"level":2,"title":"基本类型 与 引用类型","slug":"基本类型-与-引用类型"},{"level":3,"title":"如何比较一个对象是否相等？","slug":"如何比较一个对象是否相等？"},{"level":3,"title":"关于引用地址","slug":"关于引用地址"},{"level":2,"title":"什么是深拷贝？","slug":"什么是深拷贝？"},{"level":2,"title":"怎么实现呢？","slug":"怎么实现呢？"},{"level":3,"title":"1、JSON 序列化","slug":"_1、json-序列化"},{"level":3,"title":"2、for in 遍历","slug":"_2、for-in-遍历"},{"level":3,"title":"3、lodash函数库","slug":"_3、lodash函数库"},{"level":3,"title":"4、$.extend","slug":"_4、-extend"},{"level":3,"title":"小结一下","slug":"小结一下"},{"level":2,"title":"那浅拷贝又是什么？","slug":"那浅拷贝又是什么？"},{"level":2,"title":"浅拷贝的实现","slug":"浅拷贝的实现"},{"level":3,"title":"1、for in","slug":"_1、for-in"},{"level":3,"title":"2、Object.assign","slug":"_2、object-assign"},{"level":3,"title":"小结一下","slug":"小结一下-2"},{"level":2,"title":"总结","slug":"总结"},{"level":2,"title":"参考文档","slug":"参考文档"}],"relativePath":"docs/depth-Copy.md","lastUpdated":1631689037000}';var e={};const c=a('<h2 id="前言"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>再次谈及深拷贝，已经过了两三年了！花有重开日人无再少年啊，从当初的懵懵懂懂到现在的油腻大叔，害</p><h2 id="基本类型-与-引用类型"><a class="header-anchor" href="#基本类型-与-引用类型" aria-hidden="true">#</a> 基本类型 与 引用类型</h2><p>在这里我们先说明 <code>基本类型</code> 与 <code>引用类型</code> 的区别</p><p><strong>基本数据类型</strong>：直接存储在<code>栈 (stack)</code> 中的数据</p><p>String, Number, Boolean, Null, Undefined，Symbol</p><div class="language-js"><pre><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span>\n<span class="token keyword">let</span> b <span class="token operator">=</span> a\nb <span class="token operator">=</span> <span class="token number">2</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>\n<span class="token comment">// 1 , 2</span>\n</code></pre></div><p><code>a</code> 与 <code>b</code> 变量 都是基本类型，我们直接修改 b ，a 是不会被影响到的</p><p><strong>引用数据类型</strong>：存储的是该对象在栈中引用，真实的数据存储在<code>堆（heap）</code></p><p>Object 、Array 、Function 、Data</p><p>题来！！</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n  age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n  age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">===</span> obj1<span class="token punctuation">)</span>\n</code></pre></div><p>输出什么？</p><p>相信有一部分同学已经知道了是 <code>false</code>,那是为什么呢，真相就是引用地址不同因为是引用类型</p><blockquote><p>引用类型的变量，== 和 === 只会判断引用的地址是否相同，而不会判断对象具体里属性以及值是否相同</p></blockquote><h3 id="如何比较一个对象是否相等？"><a class="header-anchor" href="#如何比较一个对象是否相等？" aria-hidden="true">#</a> 如何比较一个对象是否相等？</h3><p>1.JSON.stringify</p><div class="language-js"><pre><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment">// true</span>\n</code></pre></div><p>我们现在是将<code>obj</code> 转成了 <code>string</code> 类型，不会对比引用地址</p><div class="language-js"><pre><code><span class="token string">&#39;{&quot;name&quot;:&quot;严家辉&quot;,&quot;age&quot;:18}&#39;</span> <span class="token operator">===</span> <span class="token string">&#39; {&quot;age&quot;:18,&quot;name&quot;:&quot;严家辉&quot;}&#39;</span>\n</code></pre></div><p>但是这样有一个问题</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n  age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>\n  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span>\n<span class="token punctuation">}</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre></div><p>将 <code>obj1</code> 的顺序修改了一遍之后？现在这两个对象是否相等？还是这样转为字符串，肯定返回<code> false</code> 嘛</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f723df68e91b4b599622a0aa6f99f709~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>那么我们需要如何判断两个对象（<code>不定顺序的kv</code>）是否相等呢？</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n  age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>\n  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">isSame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj1<span class="token punctuation">,</span> obj2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token keyword">var</span> obj1keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">var</span> obj2keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj2keys<span class="token punctuation">.</span>length <span class="token operator">!==</span> obj1keys<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token boolean">false</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> obj1keys<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> key <span class="token operator">=</span> obj1keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj2keys<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj2<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> obj1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isSame</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>obj1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>\n</code></pre></div><p>这样对象值为基本数据类型的不管是顺序是否一致都可以对比了</p><h3 id="关于引用地址"><a class="header-anchor" href="#关于引用地址" aria-hidden="true">#</a> 关于引用地址</h3><p>好了，我们回过头来看看这个</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n  age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">let</span> obj1 <span class="token operator">=</span> obj\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">===</span> obj1<span class="token punctuation">)</span>\n</code></pre></div><p>我们在之前说过引用类型的 == 、=== 只是判断它的引用地址是否相同</p><p>那么它在这里的引用地址肯定是一样的，故打印 true</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd87cf195e8d462e8604fc2dfbcdeccc~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>那么我现在需要修改 <code>obj1</code> 的 <code>age </code>为 24</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n  age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">let</span> obj1 <span class="token operator">=</span> obj\nobj1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">24</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;obj&#39;</span><span class="token punctuation">,</span>obj<span class="token punctuation">)</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;obj1&#39;</span><span class="token punctuation">,</span>obj1<span class="token punctuation">)</span>\n</code></pre></div><p>输出什么呢？</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/45dbdf257cd84de892bf31dbf16d46fe~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>为啥obj也会改变呢</p><blockquote><p>当我们使用=将这些变量赋值到另外的变量，实际上是将对应的值拷贝了一份，然后赋值给新的变量。</p><p>对象是通过引用传递，而不是值传递。也就是说，变量赋值只会将地址传递过去。</p></blockquote><p>故我们修改 <code>obj1</code> 其实也是修改的 <code>obj</code> 本身</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7c9b9d6ff3d74be1a322ef54f09e4880~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>那么问题来了，假如我们在项目上面有个这样的需求</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d965419fc375411199501141b6d394c4~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>也就是我们目标对象 <code>data</code> ，a 函数先执行，然后执行b函数，但是b函数的要用到 <code>data.name</code> 为严家辉</p><div class="language-js"><pre><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> data<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;老严&#39;</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6212290bddf14ba881021d90d833a43a~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>在这里我们就需要了解一下深拷贝了</p><h2 id="什么是深拷贝？"><a class="header-anchor" href="#什么是深拷贝？" aria-hidden="true">#</a> 什么是深拷贝？</h2><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9d74b7a4e0dd4b5abe050907945bc37e~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>在图中我们可以看到我们在内存中新开了一个堆用来拷贝obj的数据，但是修改obj1不会影响obj</p><blockquote><p>建一个新的对象或数组，将原对象的各项属性的“值”（数组的所有元素）拷贝过来，是“数据”而不是“引用地址” 我们希望在改变新的对象的时候，不影响原对象</p></blockquote><h2 id="怎么实现呢？"><a class="header-anchor" href="#怎么实现呢？" aria-hidden="true">#</a> 怎么实现呢？</h2><h3 id="_1、json-序列化"><a class="header-anchor" href="#_1、json-序列化" aria-hidden="true">#</a> 1、JSON 序列化</h3><div class="language-js"><pre><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n    other<span class="token operator">:</span> <span class="token punctuation">{</span>\n        gender<span class="token operator">:</span> <span class="token string">&quot;男&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 核心内容</span>\n    <span class="token keyword">let</span> data1 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    data1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;老严&#39;</span>\n    data1<span class="token punctuation">.</span>other<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a函数&#39;</span><span class="token punctuation">,</span>data1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6b8119603f14443d822d7a6cc77ea1ba~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>先通过 <code>JSON.stringify</code> 将对象转为字符串再重新序列化为对象。</p><p>这个应该是最简单的深拷贝了</p><p>缺点是如果对象中包含函数会丢失</p><div class="language-js"><pre><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n    other<span class="token operator">:</span> <span class="token punctuation">{</span>\n        gender<span class="token operator">:</span> <span class="token string">&quot;男&quot;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  \t<span class="token comment">// + 个test函数</span>\n    <span class="token function-variable function">test</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data1 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    data1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;老严&#39;</span>\n    data1<span class="token punctuation">.</span>other<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a函数&#39;</span><span class="token punctuation">,</span>data1<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p>看看 <code>test</code> 凉了没</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b2f61c6a6134255a3a563fc342317cb~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><h3 id="_2、for-in-遍历"><a class="header-anchor" href="#_2、for-in-遍历" aria-hidden="true">#</a> 2、for in 遍历</h3><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">deepCopy</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 判断是数组还是对象</span>\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">.</span>splice <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token comment">//如果对象的属性值为object的时候，递归调用deepClone,即在吧某个值对象复制一份到新的对象的对应值中。</span>\n                result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n                <span class="token comment">//如果对象的属性值不为object的时候，直接复制参数对象的每一个键值到新的对象对应的键值对中。</span>\n                result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n      \t<span class="token comment">// 返回拷贝完成后数据</span>\n        <span class="token keyword">return</span> result<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// 使用</span>\n<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n    other<span class="token operator">:</span> <span class="token punctuation">{</span>\n        gender<span class="token operator">:</span> <span class="token string">&quot;男&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data1 <span class="token operator">=</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n    data1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;隔壁小花&#39;</span>\n    data1<span class="token punctuation">.</span>other<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a函数&#39;</span><span class="token punctuation">,</span>data1<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p>通过遍历数据返回一个拷贝后船新的数据</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0aaf8f705f4945ecac32f0a836393a2d~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>缺点：据说如果数据深度 &gt; 1000+ 会爆栈</p><h3 id="_3、lodash函数库"><a class="header-anchor" href="#_3、lodash函数库" aria-hidden="true">#</a> 3、lodash函数库</h3><p>使用lodash函数库来进行深拷贝</p><p>html</p><div class="language-html"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre></div><p>js</p><div class="language-js"><pre><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n    other<span class="token operator">:</span> <span class="token punctuation">{</span>\n        gender<span class="token operator">:</span> <span class="token string">&quot;男&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 核心代码</span>\n    <span class="token keyword">let</span> data1 <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n    data1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;隔壁小花&#39;</span>\n    data1<span class="token punctuation">.</span>other<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a函数&#39;</span><span class="token punctuation">,</span>data1<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a3d726672dc4d1c88b1aa42239d0c85~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><h3 id="_4、-extend"><a class="header-anchor" href="#_4、-extend" aria-hidden="true">#</a> 4、$.extend</h3><p>html</p><div class="language-html"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://code.jquery.com/jquery-2.1.1.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre></div><p>js</p><div class="language-js"><pre><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n    other<span class="token operator">:</span> <span class="token punctuation">{</span>\n        gender<span class="token operator">:</span> <span class="token string">&quot;男&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 核心代码</span>\n    <span class="token keyword">let</span> data1 <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    data1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;隔壁老王&#39;</span>\n    data1<span class="token punctuation">.</span>other<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a函数&#39;</span><span class="token punctuation">,</span>data1<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/381a01796c664b99a79fb8b1f6c328a9~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><h3 id="小结一下"><a class="header-anchor" href="#小结一下" aria-hidden="true">#</a> 小结一下</h3><p>推荐使用第一种或者第二种，后面两种需要通过引入外部库才行</p><p>其实还有其他的方法可以实现深拷贝，比如 Proxy 、树遍历等</p><h2 id="那浅拷贝又是什么？"><a class="header-anchor" href="#那浅拷贝又是什么？" aria-hidden="true">#</a> 那浅拷贝又是什么？</h2><p>万物皆有对立面，有深便有浅</p><p>刚刚我们说深拷贝是将原对象的各项属性的“值”（数组的所有元素）拷贝过来，<strong>不是引用地址</strong>，那么浅拷贝就是 <strong>拷贝原对象的引用地址</strong></p><blockquote><p>对于浅拷贝而言，就是只拷贝对象的引用，而不深层次的拷贝对象的值，多个对象指向堆内存中的同一对象，任何一个修改都会使得所有对象的值修改，因为它们公用一条数据</p></blockquote><p>找到前面的例子和图，这就是一个最典型的浅拷贝</p><div class="language-js"><pre><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>\n  name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n  age<span class="token operator">:</span> <span class="token number">18</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">let</span> obj1 <span class="token operator">=</span> obj\nobj1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">24</span>\n</code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd6ba26f0bb34147be6149826d9fd34f~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>这下明白了吗？</p><p>啥，还不明白 ，那我们再写俩栗子吧</p><h2 id="浅拷贝的实现"><a class="header-anchor" href="#浅拷贝的实现" aria-hidden="true">#</a> 浅拷贝的实现</h2><h3 id="_1、for-in"><a class="header-anchor" href="#_1、for-in" aria-hidden="true">#</a> 1、for in</h3><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">deepCopy</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">.</span>splice <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          \t <span class="token comment">// 我们直接去掉递归，让第二层的数据直接赋值（引用地址）</span>\n             result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> result<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n    other<span class="token operator">:</span> <span class="token punctuation">{</span>\n        gender<span class="token operator">:</span> <span class="token string">&quot;男&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> data1 <span class="token operator">=</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    data1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;隔壁老王&#39;</span>\n    data1<span class="token punctuation">.</span>other<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a函数&#39;</span><span class="token punctuation">,</span>data1<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/058e37cc383d42058f7bf45d8bb065e1~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><p>我们直接使用深拷贝的第二个实现方式删除递归，让它直接赋值（引用地址），这就实现了一个浅拷贝</p><h3 id="_2、object-assign"><a class="header-anchor" href="#_2、object-assign" aria-hidden="true">#</a> 2、Object.assign</h3><div class="language-js"><pre><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;严家辉&#39;</span><span class="token punctuation">,</span>\n    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>\n    other<span class="token operator">:</span> <span class="token punctuation">{</span>\n        gender<span class="token operator">:</span> <span class="token string">&quot;男&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 核心代码</span>\n    <span class="token keyword">let</span> data1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    data1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;城中村村花&#39;</span>\n    data1<span class="token punctuation">.</span>other<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">&#39;女&#39;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a函数&#39;</span><span class="token punctuation">,</span>data1<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;b函数&#39;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span> <span class="token comment">// 老严</span>\n<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3c6dd93db774ed1a874f53f3d2d7682~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p><h3 id="小结一下-2"><a class="header-anchor" href="#小结一下-2" aria-hidden="true">#</a> 小结一下</h3><p>对于第一层的数据来说确实是拷贝成功了，但是在对象的属性是引用类型数据时我们还是拷贝的引用地址</p><h2 id="总结"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>深浅拷贝的区别就是前者将原数据重新复制了一份然后新开了一个地址，后者则是将原数据的引用地址拷贝了一份而已</p><p>如有错误，望各位不吝赐教。</p><h2 id="参考文档"><a class="header-anchor" href="#参考文档" aria-hidden="true">#</a> 参考文档</h2><p><a href="https://www.jianshu.com/p/f4329eb1bace" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/f4329eb1bace</a></p><p><a href="https://segmentfault.com/a/1190000018592552?utm_source=sf-related" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000018592552?utm_source=sf-related</a></p>',107);e.render=function(a,o,e,l,u,k){const i=t("Comment");return p(),n("div",null,[c,s(i)])};export default e;export{o as __pageData};
